<div class="content-title">
	<h2>Footnote Query</h2>
	<jhi-alert></jhi-alert>
</div>
<div class="panel">
	<div class="panel-body">
		<div class="filter-hero">
			<div class="filter-label semibold show">Hide Filter</div>
			<div class="filter-area">
				<div class="clearfix">
					<form name="ftntQueryForm" role="form" novalidate>
						<div class="col-md-3 no-lpad">
							<div class="form-group">
								<div class="custom-label semibold">Carrier</div>
								<div class="input-group">
									<input type="text" class="form-control" name="cxr" id="cxr" ng-class="{'must-fill' : ftntQueryForm.cxr.$invalid}"
										ng-minlength="2" ng-model="vm.paramCarrier" placeholder="minimum 2 characters.." uppercase required />

									<span ng-click="vm.showCarrierModal()"
										class="input-group-addon"><i class="fa fa-folder"></i>
									</span>
								</div>
								
							</div>
							<div class="form-group">
								<div class="custom-label semibold">Footnote</div>
								<div class="no-rpad">
									<input type="text" class="form-control" name="footNote"
										id="ftnt" ng-model="vm.queryParams.ftnt" uppercase />
								</div>
							</div>
							<div class="form-group">
							<div class="checkbox-wrapper">
								<label> <input type="checkbox" name="includeDisc"
									ng-model="vm.queryParams.includeDisc"> Include
									Discontinued Sequences
								</label>
							</div>
							</div>
						</div>

						<div class="col-md-3 no-lpad">
							<div class="form-group">
								<div class="custom-label semibold">Tariff Number</div>
								<div class="input-group">
									<input id="ftntTarNo" type="text" name="ftntTarNo"
										class="form-control" ng-model="vm.paramTarNo" uppercase>

									<span ng-click="vm.showTariffModal()" class="input-group-addon"><i
										class="fa fa-folder"></i> </span>
								</div>
							</div>
							<div class="form-group">
								<div class="custom-label semibold">Category</div>
								<div class="no-rpad">
									<select class="form-control" name="category" id="catNo"
										ng-model="vm.queryParams.catNo">
										<option value="">All</option>
										<option value="003">03 - Seasonality Only</option>
										<option value="011">11 - Blackout Dates Only</option>
										<option value="014">14 - Travel Restrictions Only</option>
										<option value="015">15 - Sales Restrictions Only</option>
										<option value="023">23 - Miscellaneous Provisions
											Only</option>
										<option value="comb">14 & 15 - Travel &
											SalesRestrictions</option>
									</select>
								</div>
							</div>
						</div>

						<div class="col-md-6 no-pad">
							<div class="form-group absolute-datepicker">
								<div class="custom-label semibold">Sale Date</div>
								<div class="row no-mar">
									<div class="col-md-4 no-lpad">
										<input type="text" class="form-control"
											ng-click="vm.openCalendar($event, 'saleDateFrom')"
											is-open="vm.datePickerOpenStatus['saleDateFrom']"
											datetime-picker="{{vm.dateFormat}}" enable-time="false"
											name="saleDateFrom" id="dtpSaleStart"
											ng-model="vm.queryParams.saleDateFrom" placeholder="From"
											ng-disabled="vm.queryParams.catNo == '023' || vm.queryParams.catNo == '003' || vm.queryParams.catNo == '011' || vm.queryParams.catNo == '014'" />
									</div>
									<div class="col-md-4 no-lpad">
										<input type="text" class="form-control"
											ng-click="vm.openCalendar($event, 'saleDateTo')"
											is-open="vm.datePickerOpenStatus['saleDateTo']"
											datetime-picker="{{vm.dateFormat}}" enable-time="false"
											name="saleDateTo" id="dtpSaleEnd"
											ng-model="vm.queryParams.saleDateTo" placeholder="To"
											ng-disabled="vm.queryParams.catNo == '023' || vm.queryParams.catNo == '003' || vm.queryParams.catNo == '011' || vm.queryParams.catNo == '014'" />
									</div>
									<div class="col-md-4 no-pad">
										<select class="form-control" name="saleOption" id="saleOpt"
											ng-model="vm.queryParams.saleDateType"
											ng-disabled="vm.queryParams.catNo == '023' || vm.queryParams.catNo == '003' || vm.queryParams.catNo == '011' || vm.queryParams.catNo == '014'">
											<option value="1">Active In</option>
											<option value="2">Exact Match</option>
										</select>
									</div>
								</div>
							</div>

							<div class="form-group absolute-datepicker">
								<div class="custom-label semibold">Travel Start/End</div>
								<div class="row no-mar">
									<div class="col-md-4 no-lpad">
										<input type="text" class="form-control"
											ng-click="vm.openCalendar($event, 'travelDateFrom')"
											is-open="vm.datePickerOpenStatus['travelDateFrom']"
											datetime-picker="{{vm.dateFormat}}" enable-time="false"
											name="travelDateFrom" id="dtpTravelStart"
											ng-model="vm.queryParams.travelDateFrom" placeholder="From"
											ng-disabled="vm.queryParams.catNo == '023' || vm.queryParams.catNo == '003' || vm.queryParams.catNo == '011' || vm.queryParams.catNo == '015'" />
									</div>
									<div class="col-md-4 no-lpad">
										<input type="text" class="form-control"
											ng-click="vm.openCalendar($event, 'travelDateTo')"
											is-open="vm.datePickerOpenStatus['travelDateTo']"
											datetime-picker="{{vm.dateFormat}}" enable-time="false"
											name="travelDateTo" id="dtpTravelEnd"
											ng-model="vm.queryParams.travelDateTo" placeholder="To"
											ng-disabled="vm.queryParams.catNo == '023' || vm.queryParams.catNo == '003' || vm.queryParams.catNo == '011' || vm.queryParams.catNo == '015'" />
									</div>
									<div class="col-md-4 no-pad">
										<select class="form-control" name="travelOption"
											id="travelOpt" ng-model="vm.queryParams.travelDateType"
											ng-disabled="vm.queryParams.catNo == '023' || vm.queryParams.catNo == '003' || vm.queryParams.catNo == '011' || vm.queryParams.catNo == '015'">
											<option value="1">Active In</option>
											<option value="2">Exact Match</option>
										</select>
									</div>
								</div>
							</div>

							<div class="form-group absolute-datepicker">
								<div class="custom-label semibold">Completed By/Ind</div>
								<div class="row no-mar">
									<div class="col-md-4 no-lpad">
										<input type="text" class="form-control"
											ng-click="vm.openCalendar($event, 'completedDateFrom')"
											is-open="vm.datePickerOpenStatus['completedDateFrom']"
											datetime-picker="{{vm.dateFormat}}" enable-time="false"
											name="travelDateFrom" id="completedByStart"
											ng-model="vm.queryParams.completedDateFrom"
											placeholder="From"
											ng-disabled="vm.queryParams.catNo == '023' || vm.queryParams.catNo == '003' || vm.queryParams.catNo == '011' || vm.queryParams.catNo == '015'" />
									</div>
									<div class="col-md-4 no-lpad">
										<select class="form-control" name="travelOption"
											id="travelOpt" ng-model="vm.queryParams.travelOpt"
											ng-disabled="vm.queryParams.catNo == '023' || vm.queryParams.catNo == '003' || vm.queryParams.catNo == '011' || vm.queryParams.catNo == '015'">
											
											<option value="P">P - Trip Completed</option>
											<option value="C">C - Trip Commence</option>
										</select>
									</div>
									<div class="col-md-4 no-pad">
										<select class="form-control" name="completedOption"
											id="completedOption"
											ng-disabled="vm.queryParams.catNo == '023' || vm.queryParams.catNo == '003' || vm.queryParams.catNo == '011' || vm.queryParams.catNo == '015'">
											<option value="2">Exact Match</option>
										</select>
									</div>
								</div>
							</div>
						</div>

						<div class="clearfix">
							<div class="pull-right pv1">
								<button type="button" class="btn btn-default small"
									ng-disabled="ftntQueryForm.$invalid"
									ng-click="vm.loadAvailable()">Show Available Footnotes</button>
								<button type="button" class="btn btn-default small"
									ng-disabled="ftntQueryForm.$invalid"
									ng-click="vm.loadExpired()">Show Expired Footnotes</button>
								<button type="button" class="btn btn-default small"
									ng-disabled="ftntQueryForm.$invalid" ng-click="vm.loadAll()">Query</button>
								<button type="reset" ng-click="vm.reset()"
									class="btn btn-default small">Reset</button>
							</div>
						</div>
					</form>
				</div>
			</div>
		</div>

		<div class="table-wrapper" ng-if="vm.footnoteQueries">
			<div class="datatable-wrapper form-inline">
				<div class="table-responsive">
					<table class="table table-striped table-bordered datatable">
						<thead>
							<tr>
								<th>No</th>
								<th>Carrier Code</th>
								<th>Fare/Addon</th>
								<th>Tariff No</th>
								<th>Tariff Code</th>
								<th>Footnote</th>
								<th>Fare/Addon Count</th>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="ftntQuery in vm.footnoteQueries"
								ng-click="vm.selectedRow = ftntQuery; vm.getFtnt(ftntQuery); vm.getFtnt2(ftntQuery);  vm.showDetail()"
								ng-class="{'selected': vm.selectedRow == ftntQuery}">
								<td>{{($index + 1)+((vm.page-1)*vm.itemsPerPage) }}</td>
								<td>{{ftntQuery.cxr}}</td>
								<td>{{ftntQuery.fareAddon}}</td>
								<td>{{ftntQuery.tarNo}}</td>
								<td>{{ftntQuery.tarCd}}</td>
								<td>{{ftntQuery.ftnt}}</td>
								<td>{{ftntQuery.fareAddonCount}}</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
		
		<div class="text-center" ng-if="vm.footnoteQueries">
			<jhi-item-count page="vm.page" total="vm.queryCount"
				items-per-page="vm.itemsPerPage"></jhi-item-count>
			<uib-pagination class="pagination-sm" total-items="vm.totalItems"
				items-per-page="vm.itemsPerPage" ng-model="vm.page"
				ng-change="vm.loadAll()"></uib-pagination>
		</div>

		<div class="table-wrapper" ng-if="vm.footnoteQueryCategories">
			<div class="datatable-wrapper form-inline">
				<div class="table-responsive">
					<table class="table table-striped table-bordered datatable">
						<thead>
							<tr>
								<th>No</th>
								<th>Cat No</th>
								<th>Seq No</th>
								<th>Loc 1 Type</th>
								<th>Loc 1</th>
								<th>Loc 2 Type</th>
								<th>Loc 2</th>
								<th>Fare Basis</th>
								<th>Fare Type</th>
								<th>Season Type</th>
								<th>Day Of Week</th>
								<th>OW/RT>
								<th>Routing No</th>
								<th>Footnote</th>
								<th>Effective Date</th>
								<th>Discontinue Date</th>
								<th>Travel Start</th>
								<th>Travel End</th>
								<th>Sale Start</th>
								<th>Sale End</th>
								<th>Travel Complete</th>
								<th>Travel Comp. Ind</th>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="rq in vm.footnoteQueryCategories">
								<td>{{$index + 1}}</td>
								<td>{{rq.catNo}}</td>
								<td>{{rq.seqNo}}</td>
								<td>{{rq.locType1}}</td>
								<td>{{rq.loc1}}</td>
								<td>{{rq.locType2}}</td>
								<td>{{rq.loc2}}</td>
								<td>{{rq.fareClass}}</td>
								<td>{{rq.fareType}}</td>
								<td>{{rq.seasonType}}</td>
								<td>{{rq.dayOfWeekType}}</td>
								<td>{{rq.owrt}}</td>
								<td>{{rq.routingNo}}</td>
								<td>{{rq.ftnt}}</td>
								<td><span ng-if="rq.effDate=='indef'"></span>
									<span ng-if="rq.effDate!='indef'">{{rq.effDate | date:'medium'}}</span></td>
								<td><span ng-if="rq.discDate=='indef'"></span>
									<span ng-if="rq.discDate!='indef'">{{rq.discDate | date:'medium'}}</span></td>
								<td><span ng-if="rq.travelStart=='indef'"></span>
									<span ng-if="rq.travelStart!='indef'">{{rq.travelStart | date:'medium'}}</span></td>
								<td><span ng-if="rq.travelEnd=='indef'"></span>
									<span ng-if="rq.travelEnd!='indef'">{{rq.travelEnd | date:'medium'}}</span></td>
								<td><span ng-if="rq.saleStart=='indef'"></span>
									<span ng-if="rq.saleStart!='indef'">{{rq.saleStart | date:'medium'}}</span></td>
								<td><span ng-if="rq.saleEnd=='indef'"></span>
									<span ng-if="rq.saleEnd!='indef'">{{rq.saleEnd | date:'medium'}}</span></td>
								<td><span ng-if="rq.travelComplete=='indef'"></span>
									<span ng-if="rq.travelComplete!='indef'">{{rq.travelComplete | date:'medium'}}</span></td>
								<td>{{rq.travelCompInd}}</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>

		<div class="col-md-12 text-center" ng-if="vm.isLoadingRule">
			<div class="spinner yellow">
			  <div class="double-bounce1"></div>
			  <div class="double-bounce2"></div>
			</div>
		</div>
		<div class="additional-info-wrapper" ng-if="vm.footnoteQueryCategories2">
			<div class="clearfix">
				<div class="pull-left ph5px additional-container" ng-repeat="cat in vm.footnoteQueryCategories2 track by cat.catNo">
					<div class="additional-info" ng-click="vm.showCategoryDetail(cat)" ng-class="{'lightyellow': cat.type.includes('F'), 'yellow': cat.type.includes('R'), 'blue': cat.type == 'G'}">
	        			{{cat.catNo}} {{cat.catName}} <span ng-if="cat.type != undefined && cat.type != ''">({{cat.type}})</span>
		      		</div>
				</div>
				<div class="pull-left ph5px additional-container">
					<div class="additional-info action dropdown custom" ng-click="vm.actionClicked = !vm.actionClicked">
		      			Action <i class="fa fa-caret-down pull-right"></i>
		      			<div class="action-wrapper" ng-if="vm.actionClicked">
		      				<a ng-click="vm.showLegend()">Show Legend</a>
		      				<a ng-click="vm.viewFullText()">View Full Text</a>
		      			</div>
		      		</div>
	      		</div>
			</div>
   		</div>

		
	</div>
</div>